<?xml version="1.0" encoding="utf-8"?><!DOCTYPE article  PUBLIC '-//OASIS//DTD DocBook XML V4.4//EN'  'http://www.docbook.org/xml/4.4/docbookx.dtd'><article><articleinfo><title>utilities/DiffusionCoefficientTool</title><revhistory><revision><revnumber>98</revnumber><date>28.08.2015 10:26:26</date><authorinitials>toni</authorinitials></revision><revision><revnumber>97</revnumber><date>28.08.2015 10:22:54</date><authorinitials>toni</authorinitials></revision><revision><revnumber>96</revnumber><date>12.06.2014 18:01:21</date><authorinitials>toni</authorinitials></revision><revision><revnumber>95</revnumber><date>11.06.2014 14:33:43</date><authorinitials>toni</authorinitials></revision><revision><revnumber>94</revnumber><date>30.01.2014 15:11:48</date><authorinitials>toni</authorinitials></revision><revision><revnumber>93</revnumber><date>30.01.2014 15:10:55</date><authorinitials>toni</authorinitials></revision><revision><revnumber>92</revnumber><date>30.01.2014 15:04:25</date><authorinitials>toni</authorinitials></revision><revision><revnumber>91</revnumber><date>30.01.2014 14:56:50</date><authorinitials>toni</authorinitials></revision><revision><revnumber>90</revnumber><date>03.12.2013 10:32:26</date><authorinitials>toni</authorinitials></revision><revision><revnumber>89</revnumber><date>05.03.2013 10:38:01</date><authorinitials>toni</authorinitials></revision><revision><revnumber>88</revnumber><date>20.02.2013 09:13:13</date><authorinitials>toni</authorinitials></revision><revision><revnumber>87</revnumber><date>19.02.2013 20:02:55</date><authorinitials>toni</authorinitials></revision><revision><revnumber>86</revnumber><date>19.02.2013 19:47:28</date><authorinitials>toni</authorinitials></revision><revision><revnumber>85</revnumber><date>19.02.2013 08:57:15</date><authorinitials>gianni</authorinitials></revision><revision><revnumber>84</revnumber><date>19.02.2013 08:52:01</date><authorinitials>toni</authorinitials></revision><revision><revnumber>83</revnumber><date>24.01.2013 14:17:26</date><authorinitials>toni</authorinitials></revision><revision><revnumber>82</revnumber><date>24.01.2013 13:44:46</date><authorinitials>toni</authorinitials></revision><revision><revnumber>81</revnumber><date>18.01.2013 12:26:15</date><authorinitials>toni</authorinitials></revision><revision><revnumber>80</revnumber><date>18.01.2013 12:23:32</date><authorinitials>toni</authorinitials></revision><revision><revnumber>79</revnumber><date>19.12.2012 22:14:15</date><authorinitials>toni</authorinitials></revision><revision><revnumber>78</revnumber><date>19.12.2012 22:12:12</date><authorinitials>toni</authorinitials></revision><revision><revnumber>77</revnumber><date>17.12.2012 18:11:47</date><authorinitials>toni</authorinitials></revision><revision><revnumber>76</revnumber><date>17.12.2012 18:10:04</date><authorinitials>toni</authorinitials></revision><revision><revnumber>75</revnumber><date>17.12.2012 17:56:03</date><authorinitials>toni</authorinitials></revision><revision><revnumber>74</revnumber><date>17.12.2012 17:55:34</date><authorinitials>toni</authorinitials></revision><revision><revnumber>73</revnumber><date>17.12.2012 16:09:47</date><authorinitials>toni</authorinitials></revision><revision><revnumber>72</revnumber><date>17.12.2012 16:07:17</date><authorinitials>toni</authorinitials></revision><revision><revnumber>71</revnumber><date>17.12.2012 16:06:27</date><authorinitials>toni</authorinitials></revision><revision><revnumber>70</revnumber><date>17.12.2012 15:45:39</date><authorinitials>toni</authorinitials></revision><revision><revnumber>69</revnumber><date>17.12.2012 14:43:59</date><authorinitials>toni</authorinitials></revision><revision><revnumber>68</revnumber><date>17.12.2012 13:59:13</date><authorinitials>toni</authorinitials></revision><revision><revnumber>67</revnumber><date>17.12.2012 13:57:56</date><authorinitials>toni</authorinitials></revision><revision><revnumber>66</revnumber><date>17.12.2012 13:53:39</date><authorinitials>toni</authorinitials></revision><revision><revnumber>65</revnumber><date>17.12.2012 11:51:29</date><authorinitials>toni</authorinitials></revision><revision><revnumber>64</revnumber><date>17.12.2012 11:49:53</date><authorinitials>toni</authorinitials><revremark>Revert to revision 61.</revremark></revision><revision><revnumber>63</revnumber><date>17.12.2012 11:48:49</date><authorinitials>toni</authorinitials></revision><revision><revnumber>62</revnumber><date>16.12.2012 11:53:15</date><authorinitials>toni</authorinitials></revision><revision><revnumber>61</revnumber><date>15.12.2012 16:49:49</date><authorinitials>toni</authorinitials></revision><revision><revnumber>60</revnumber><date>15.12.2012 16:47:53</date><authorinitials>toni</authorinitials></revision><revision><revnumber>59</revnumber><date>12.05.2012 16:32:42</date><authorinitials>toni</authorinitials></revision><revision><revnumber>58</revnumber><date>12.05.2012 16:03:31</date><authorinitials>toni</authorinitials></revision><revision><revnumber>57</revnumber><date>12.05.2012 16:02:55</date><authorinitials>toni</authorinitials></revision><revision><revnumber>56</revnumber><date>20.09.2011 09:54:26</date><authorinitials>toni</authorinitials></revision><revision><revnumber>55</revnumber><date>20.09.2011 09:53:41</date><authorinitials>toni</authorinitials></revision><revision><revnumber>54</revnumber><date>20.09.2011 09:51:31</date><authorinitials>toni</authorinitials></revision><revision><revnumber>53</revnumber><date>28.07.2011 09:25:28</date><authorinitials>toni</authorinitials></revision><revision><revnumber>52</revnumber><date>28.07.2011 09:24:55</date><authorinitials>toni</authorinitials></revision><revision><revnumber>51</revnumber><date>21.02.2011 22:02:06</date><authorinitials>toni</authorinitials></revision><revision><revnumber>50</revnumber><date>18.02.2011 01:21:33</date><authorinitials>toni</authorinitials></revision><revision><revnumber>49</revnumber><date>18.02.2011 01:19:35</date><authorinitials>toni</authorinitials></revision><revision><revnumber>48</revnumber><date>18.02.2011 01:18:27</date><authorinitials>toni</authorinitials></revision><revision><revnumber>47</revnumber><date>18.02.2011 01:17:39</date><authorinitials>toni</authorinitials></revision><revision><revnumber>46</revnumber><date>18.02.2011 01:14:19</date><authorinitials>toni</authorinitials></revision><revision><revnumber>45</revnumber><date>18.02.2011 01:06:50</date><authorinitials>toni</authorinitials><revremark>## page was copied from utilities/DensityProfileTool</revremark></revision><revision><revnumber>44</revnumber><date>09.02.2011 16:06:45</date><authorinitials>toni</authorinitials></revision><revision><revnumber>43</revnumber><date>09.02.2011 16:04:37</date><authorinitials>toni</authorinitials></revision><revision><revnumber>42</revnumber><date>09.02.2011 16:00:15</date><authorinitials>toni</authorinitials></revision><revision><revnumber>41</revnumber><date>09.02.2011 15:39:28</date><authorinitials>toni</authorinitials></revision><revision><revnumber>40</revnumber><date>09.02.2011 15:38:01</date><authorinitials>toni</authorinitials></revision><revision><revnumber>39</revnumber><date>09.02.2011 15:12:51</date><authorinitials>toni</authorinitials></revision><revision><revnumber>38</revnumber><date>09.02.2011 15:11:24</date><authorinitials>toni</authorinitials></revision><revision><revnumber>37</revnumber><date>09.02.2011 15:11:06</date><authorinitials>toni</authorinitials></revision><revision><revnumber>36</revnumber><date>09.02.2011 15:10:25</date><authorinitials>toni</authorinitials></revision><revision><revnumber>35</revnumber><date>09.02.2011 02:15:59</date><authorinitials>toni</authorinitials></revision><revision><revnumber>34</revnumber><date>09.02.2011 02:03:29</date><authorinitials>toni</authorinitials></revision><revision><revnumber>33</revnumber><date>09.02.2011 02:02:45</date><authorinitials>toni</authorinitials></revision><revision><revnumber>32</revnumber><date>09.02.2011 02:01:44</date><authorinitials>toni</authorinitials></revision><revision><revnumber>31</revnumber><date>09.02.2011 01:59:40</date><authorinitials>toni</authorinitials></revision><revision><revnumber>30</revnumber><date>09.02.2011 01:59:22</date><authorinitials>toni</authorinitials></revision><revision><revnumber>29</revnumber><date>09.02.2011 01:58:14</date><authorinitials>toni</authorinitials></revision><revision><revnumber>28</revnumber><date>09.02.2011 01:54:01</date><authorinitials>toni</authorinitials><revremark>new tool</revremark></revision><revision><revnumber>27</revnumber><date>18.12.2010 01:25:24</date><authorinitials>toni</authorinitials></revision><revision><revnumber>26</revnumber><date>18.12.2010 01:23:32</date><authorinitials>toni</authorinitials></revision><revision><revnumber>25</revnumber><date>18.12.2010 01:02:35</date><authorinitials>toni</authorinitials></revision><revision><revnumber>24</revnumber><date>18.12.2010 01:01:25</date><authorinitials>toni</authorinitials></revision><revision><revnumber>23</revnumber><date>18.12.2010 00:59:55</date><authorinitials>toni</authorinitials></revision><revision><revnumber>22</revnumber><date>18.12.2010 00:54:17</date><authorinitials>toni</authorinitials></revision><revision><revnumber>21</revnumber><date>18.12.2010 00:52:21</date><authorinitials>toni</authorinitials></revision><revision><revnumber>20</revnumber><date>17.12.2010 19:07:34</date><authorinitials>toni</authorinitials></revision><revision><revnumber>19</revnumber><date>17.12.2010 19:02:39</date><authorinitials>toni</authorinitials></revision><revision><revnumber>18</revnumber><date>17.12.2010 19:01:22</date><authorinitials>toni</authorinitials></revision><revision><revnumber>17</revnumber><date>17.12.2010 18:59:33</date><authorinitials>toni</authorinitials></revision><revision><revnumber>16</revnumber><date>17.12.2010 18:53:19</date><authorinitials>toni</authorinitials></revision><revision><revnumber>15</revnumber><date>17.12.2010 18:48:45</date><authorinitials>toni</authorinitials></revision><revision><revnumber>14</revnumber><date>17.12.2010 18:47:38</date><authorinitials>toni</authorinitials></revision><revision><revnumber>13</revnumber><date>17.12.2010 18:45:35</date><authorinitials>toni</authorinitials></revision><revision><revnumber>12</revnumber><date>01.11.2010 09:13:46</date><authorinitials>toni</authorinitials></revision><revision><revnumber>11</revnumber><date>31.10.2010 17:42:04</date><authorinitials>toni</authorinitials></revision><revision><revnumber>10</revnumber><date>31.10.2010 17:41:01</date><authorinitials>toni</authorinitials></revision><revision><revnumber>9</revnumber><date>31.10.2010 16:59:29</date><authorinitials>toni</authorinitials></revision><revision><revnumber>8</revnumber><date>31.10.2010 16:56:50</date><authorinitials>toni</authorinitials></revision><revision><revnumber>7</revnumber><date>31.10.2010 16:56:22</date><authorinitials>toni</authorinitials></revision><revision><revnumber>6</revnumber><date>31.10.2010 16:51:24</date><authorinitials>toni</authorinitials></revision><revision><revnumber>5</revnumber><date>31.10.2010 16:48:15</date><authorinitials>toni</authorinitials></revision><revision><revnumber>4</revnumber><date>31.10.2010 16:41:51</date><authorinitials>toni</authorinitials></revision><revision><revnumber>3</revnumber><date>31.10.2010 16:38:50</date><authorinitials>toni</authorinitials></revision><revision><revnumber>2</revnumber><date>31.10.2010 16:36:37</date><authorinitials>toni</authorinitials></revision><revision><revnumber>1</revnumber><date>31.10.2010 16:36:12</date><authorinitials>toni</authorinitials></revision></revhistory></articleinfo><section><title>Diffusion Coefficient Tool (beta)</title><para>Toni Giorgino </para><itemizedlist><listitem override="none"><para>2012- (ISIB-CNR) Consiglio Nazionale delle Ricerche </para><para> 2009-2011 (GRIB-IMIM-UPF) Computational Biophysics Laboratory </para></listitem></itemizedlist><para>The <link linkend="">Diffusion Coefficient Tool</link>  is an analysis plugin for VMD that computes one, two or three-dimensional mean squared displacements (MSD)-based diffusion coefficients  of a chosen molecular species. </para><para>This is beta software. If you don't know how to compute the diffusion coefficient yourself, probably you won't be able to use this software. <emphasis role="strong">NO support or warranty is available whatsoever.</emphasis> </para><para><emphasis role="strong">Repeat.</emphasis> The Diffusion Coefficient Tool is not a magic box. It only computes mean squared displacements (MSD) at a variety of lag times (τ<!--RAW HTML: &tau;-->). The MSD is predicted by Einstein's relation to grow linearly with τ<!--RAW HTML: &tau;-->. Most often than not, this DOES NOT occur in practice, for a variety of reasons, including poor sampling or non-diffusive behavior. It is YOUR responsibility to understand why and, if you trust the linearity, to fit the slope. Please consider the following paper to be <emphasis role="strong">mandatory reading</emphasis>: <ulink url="http://utkstair.org/clausius/docs/che548/pdf/selfD.pdf">David Keffer, The Working Man's Guide to Obtaining Self Diffusion Coefficients from Molecular Dynamics Simulations</ulink>. </para><section><title>Installation</title><para>This is beta software. By downloading the software you agree to comply with the terms of GPL version 2.  </para><para><emphasis role="strong">NOTE: This code comes without any warranty of fitness for any use. It is UNSUPPORTED. After you download it, you are on your own.</emphasis> </para><para><ulink url="https://github.com/tonigi/vmd_diffusion_coefficient/releases/latest">Download</ulink> and follow the instructions therein. </para><para>You may or may not be able to get support by posting to the <ulink url="https://sourceforge.net/p/membplugin/discussion/external_tools/">External tools</ulink> forum hosted at the <ulink url="http://membplugin.sourceforge.net">MEMBPLUGIN</ulink> site. </para></section><section><title>Citation and license</title><para>Please cite the following publication: </para><para>Toni Giorgino, Computing diffusion coefficients in macromolecular simulations: the Diffusion Coefficient Tool for VMD, Submitted (2014). Available from <ulink url="http://multiscalelab.org/utilities/DiffusionCoefficientTool"/> (accessed xxx, xxx 2013). </para></section><section><title>Usage (GUI)</title><para>The plugin is accessible from VMD in <emphasis>Extensions &gt; Analysis &gt; Diffusion Coefficient Tool</emphasis>. The profile is computed for the currently loaded trajectory in the <emphasis>top</emphasis> molecule. The atom selection must match one atom per diffusing molecule; MSD values will be averaged over   the matched atoms. </para><para>Two buttons are provided to plot the <emphasis role="strong">MSD displacement</emphasis> MSD(τ<!--RAW HTML: &tau;-->) and the <emphasis role="strong">Diffusion coefficient</emphasis> D(τ<!--RAW HTML: &tau;-->). The latter is computed with the Einstein relation as <emphasis>D(τ<!--RAW HTML: &tau;-->)=MSD(τ<!--RAW HTML: &tau;-->)/2Eτ<!--RAW HTML: &tau;--></emphasis>, where <emphasis>E</emphasis> is the integer dimensionality of the system (1, 2 or 3). (Note that it's not a linear fit.) </para><para>The <emphasis role="strong">Analysis interval</emphasis> boxes allow to specify a subsection of the trajectory to be used for the MSD calculation. Only displacements in the subspace spanned by the <emphasis role="strong">Diffusion along</emphasis> axes will be considered. In other words, if <emphasis>z</emphasis> is deselected, motions along that axes will be irrelevant for the calculation of MSD and D.  </para><para>The results are given in Å<!--RAW HTML: &Aring;--><superscript>2</superscript>/ns. Conversion factors:  </para><itemizedlist><listitem><para>0.1 Å<!--RAW HTML: &Aring;--><superscript>2</superscript>/ns = 10<superscript>-12</superscript> m<superscript>2</superscript>/s = 10<superscript>-8</superscript> cm<superscript>2</superscript>/s = 1 μ<!--RAW HTML: &mu;-->m<superscript>2</superscript>/s </para></listitem><listitem><para>1 cm²/s = 10<superscript>7</superscript> Å<!--RAW HTML: &Aring;-->²/ns </para></listitem><listitem><para>1 m²/s = 10<superscript>11</superscript> Å<!--RAW HTML: &Aring;-->²/ns </para></listitem><listitem><para>1 μ<!--RAW HTML: &mu;-->m²/s = 0.1 Å<!--RAW HTML: &Aring;-->²/ns </para></listitem><listitem><para>1 Å<!--RAW HTML: &Aring;-->²/ns = 10<superscript>-7</superscript> cm²/s = 10<superscript>-11</superscript> m²/s = 10 μ<!--RAW HTML: &mu;-->m²/s </para></listitem></itemizedlist><para>Upon completion, the location of a data file with the computed profiles will be printed on the console. </para><para><emphasis role="strong">Warnings</emphasis>:  </para><itemizedlist><listitem><para><emphasis role="strong">Don't draw premature conclusions.</emphasis>  Computing converged diffusion coefficients is likely beyond your sampling capacity and patience, unless done for plenty of molecules (ie. solvent). Expect <emphasis role="strong">microseconds</emphasis> sampling. </para></listitem><listitem><para>The trajectory must not be wrapped. </para></listitem><listitem><para>A check is performed whether bonds exist between the selected atoms. This check may fail if wrong connectivity is inferred on molecule load; </para></listitem></itemizedlist></section><section><title>Usage (command line)</title><para>You need to load the package with <code>package require diffusion_coefficient</code>. The plugin can perform the following computations </para><itemizedlist><listitem><para>MSD at a given lag time (in frames). The return value will be in Å<!--RAW HTML: &Aring;-->, and its value is independent of the time units. This is the clearest (i.e. recommended) way to use the plugin. </para></listitem><listitem><para>MSD for  an interval of lag times </para></listitem><listitem><para>D, computed as above, for an interval of lag times. </para></listitem></itemizedlist><para>Invocation is self-explanatory, i.e.: </para><screen><![CDATA[VMD Diffusion Coefficient tool. Computes one, two or three-dimensional
MSD-based diffusion coefficients of a chosen molecular species.
]]><![CDATA[
Usage: diffusion_coefficient <options> <command>
]]><![CDATA[
Command is one of:
-msd <NN>     Compute mean squared displacement (MSD) at a tau of
              NN frames; equivalent to msd_interval -from NN -to NN.
              Returns a value as Angstrom^2 . This is the recommended 
              way of using the plugin.
-msd range    Compute MSD for taus between -from and -to (mandatory)
              Returns two lists of {tau} {MSD(tau)}
-d range      Compute D(tau)=MSD(tau)/(2*D*tau) between -from and
              -to (mandatory). Returns two lists of {tau} {D(tau)}]]></screen></section><section><title>Averaging</title><para><inlinemediaobject><imageobject><imagedata fileref="http://www1.multiscalelab.org//utilities/DiffusionCoefficientTool?action=AttachFile&amp;do=get&amp;target=formulas.png"/></imageobject><textobject><phrase>formulas.png</phrase></textobject></inlinemediaobject> </para><informaltable><tgroup cols="3"><colspec colname="col_0"/><colspec colname="col_1"/><colspec colname="col_2"/><tbody><row rowsep="1"><entry colsep="1" rowsep="1"><para><emphasis role="strong">Symbol above</emphasis></para></entry><entry colsep="1" rowsep="1"><para><emphasis role="strong">GUI parameter name</emphasis></para></entry><entry colsep="1" rowsep="1"><para><emphasis role="strong">Command line option</emphasis></para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para>w<subscript>f</subscript> </para></entry><entry colsep="1" rowsep="1"><para> Analysis interval from </para></entry><entry colsep="1" rowsep="1"><para> <code>-interval_from</code> </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para>w<subscript>t</subscript> </para></entry><entry colsep="1" rowsep="1"><para> Analysis interval to </para></entry><entry colsep="1" rowsep="1"><para> <code>-interval_to</code> </para></entry></row><row rowsep="1"><entry colsep="1" rowsep="1"><para>w<subscript>s</subscript> </para></entry><entry colsep="1" rowsep="1"><para> Analysis interval step </para></entry><entry colsep="1" rowsep="1"><para> <code>-interval_stride</code> </para></entry></row></tbody></tgroup></informaltable></section><section><title>Screenshot</title><para><inlinemediaobject><imageobject><imagedata fileref="http://www1.multiscalelab.org//utilities/DiffusionCoefficientTool?action=AttachFile&amp;do=get&amp;target=gui.png"/></imageobject><textobject><phrase>gui.png</phrase></textobject></inlinemediaobject> </para></section><section><title>Acknowledgments</title><para>Former support from the Agència de Gestió d'Ajuts Universitaris i de Recerca - Generalitat de Catalunya is gratefully acknowledged.  </para></section></section></article>